<%- include ("layout") %>
<body>
    <%- include ("navigation") %>
    <h2><%= post.title %></h2>
    <p><%= post.content %></p>
    <hr />
    <a href="/posts/<%= post._id %>/edit" class="button">Edit Post</a>
    <a href="/posts/<%= post._id %>/delete" class="button">Delete Post</a>
    <form action="/posts/<%= post._id %>/comments" method="POST">
        <label for="username">Name</label>
        <input id="username" name="username" type="text" required />
          
        <label for="text">Comment</label>
        <textarea id="text" name="text" rows="4" required></textarea>
          
        <button type="submit">Add Comment</button>
        </form>
    <h3>Comments</h3>
    <% if (post.comments && post.comments.length > 0) { %>
        <% post.comments.forEach(comment => { %>
            <div>
              <strong><%= comment.username %></strong>
              <p><%= comment.text %></p>
              <form action="/posts/<%= post._id %>/comments/<%= comment._id %>?_method=DELETE" method="POST" style="display: inline;">
                <button type="submit" onclick="return confirm('Are you sure you want to delete this comment?')" style="color: red;">Delete</button>
              </form>
              <form action="/posts/<%= post._id %>/comments/<%= comment._id %>?_method=PUT" method="POST" style="display: inline;">
                <input type="text" name="text" placeholder="Edit comment..." required />
                <button type="submit">Update</button>
              </form>
            </div>
            <hr />
        <% }) %>
    <% } else { %>
        <p>No comments yet. Be the first to comment!</p>
    <% } %>
</body>
</html>